test:
  override:
    - bundle exec haml index.haml index.html


deployment:
  production:
    branch: master
    commands:
      - git config --global user.name  "Circle CI"
      - git config --global user.email "circleci@example.com"
      - ${ACCESS_TOKEN?You need to provide an \$ACCESS_TOKEN to Circle CI.}
      - git clone https://$ACCESS_TOKEN:x-oauth-basic@github.com/$CIRCLE_PROJECT_USERNAME/$CIRCLE_PROJECT_REPONAME.git deploy -b gh-pages --single-branch
      - mv index.html deploy/
      - cd deploy && git add index.html && git commit -m "Deployed automatically" && git push
